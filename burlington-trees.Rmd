---
title: "A Statistical and Visual Analysis of Municipally-Maintained Trees in the City of Burlington, VT"
author: "Isabelle Franke, Caroline Green, Will Guisbond"
date: "4/15/2022"
output:
  pdf_document:
    number_sections: yes
  html_notebook:
    number_sections: yes
---
# Introduction

•	What is the source of the data?  Where and when was it created?
•	If it is a sample, from what population was it drawn, and how was the sample selected? 
•	Do you suspect any sampling bias?
•	Was it an experiment or an observational study? 
•	How were measurements taken, or questions asked?
•	Do you suspect any bias in the questions or measurements?
•	Why is this data of interest to you, and why should the class find it interesting?
•	What kind of data cleaning was necessary (R code for this must show…)

City arborists in Burlington, Vermont have maintained a comprehensive dataset containing various features of every tree planted by the city since 1982, including date planted, GPS coordinates, land use type, species, diameter, height, tree condition, and appraisal estimate. These data have important implications in environmental assessments and future sustainability efforts from the city.

# Visualization & Analysis

## Data Cleaning
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(lubridate)
library(zoo)

theme_set(theme_bw())

```

```{r data_clean}
# read in csv file
trees <- read.csv("./Burlington_Trees.csv")
library("magrittr")

# separate Geo.Point column to latitude and longitude
# and convert to numeric variables
trees <- trees %>% 
         separate(Geo.Point, c("lat", "long"), ",") %>% 
         mutate(lat = as.numeric(lat),
                long = as.numeric(long))

# separate species column into genus, species
trees <- trees %>% 
         separate(species, c("genus", "species"), ",")

# remove the "spp" included as a place holder for genus
trees$genus <- gsub(" spp", "", trees$genus)

# correct the misspelling of mapl to maple
trees$genus <- gsub("mapl", "maple", trees$genus, fixed = TRUE)
trees$genus <- gsub("maplee", "maple", trees$genus)

# convert zeros in numeric columns to NA so they will not be included in graphs
# in this case, zero values are due to lack of information, not lack of value,
# so all were converted to NA values to be filtered out later
# repeat for blank values
trees[trees == 0] <- NA
trees[trees == ""] <- NA

# convert dates to better format
trees <- trees %>% 
  mutate(modified = as.yearmon(modified, "%m/%Y"))

# cleaned data frame
head(trees)

```

## Number of Trees by Genus

```{r}
# number of trees by species
# histogram
```


## Relationship between species abundance and Land Use

```{r}
# landuse v species
# multiple bar chart
# see if certain types of trees are more common by business, residential, etc.

# format the data into a new data fram
landuse_by_genus <- xtabs(formula = ~ landuse + genus,
                       data = trees) %>% 
  prop.table(margin = "landuse") %>%  # calculates proportio
  
  # pipe into data.frame
  # Using data.frame() turns it from a table into a data frame
  data.frame() %>% 
  filter(Freq > .1) 

landuse_by_genus

landuse_species_bar <- ggplot(data = landuse_by_genus,
       mapping = aes(x = landuse,
                     fill = genus,
                     y = Freq)) + 
  
  # Now we need to tell geom_bar() to override it'd default choice of y
  # We do this with stat = "identity" (identity means "Use the y I gave you!")
  geom_bar(color = "black",
           stat = "identity",
           position = "fill") + 
  
  labs(y = "Proportion", 
       title = "Top Genus per Land Use Type",
       x = "Land Use Type") +
  
  theme(axis.text.x = element_text(angle = 30,
                                 hjust = 1))


landuse_species_bar

```

## The Trees of Burlington

```{r land_use_distrib}
# will
# map of burlington with points as trees and colored by land use type
# map of burlington with points as trees and colored by species
# facet wrap them next to each other!

```

## Appraisal Estimates

```{r}
# diameter v appraisal
# scatterplot probably

```


# Machine Learning


